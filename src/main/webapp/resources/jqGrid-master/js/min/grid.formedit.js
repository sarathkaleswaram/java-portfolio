(function(a){"function"===typeof define&&define.amd?define(["jquery","./grid.base","./jquery.fmatter","./grid.common","./jsonxml"],a):"object"===typeof exports?a(require("jquery")):a(jQuery)})(function(a){var n=a.jgrid,F=n.jqID,G=a.fn.jqGrid,Q=n.mergeCssClasses,R=n.hasOneFromClasses,X=function(a,N){return Q(n.getRes(n.guiStyles[this.p.guiStyle],a),N||"")},O=function(a){return X.call(this,"states."+a)},ka=n.feedback,ma=n.fullBoolFeedback,L=n.builderFmButon,la=function(a,n){var e=a[0].style[n];return 0<=
e.indexOf("px")?parseFloat(e):e},na=function(g,n,e){var m=e.w;n=a(n);var k=this.closest(".ui-jqgrid"),c=function(a){return m.offset()[a]-(k.offsetParent().offset()[a]+k.offset()[a]+k.position()[a]+parseFloat(k.css("border-"+a+"-width")||0))};this.data(g,{top:c("top"),left:c("left"),width:la(m,"width"),height:la(m,"height"),dataheight:la(n,"height")||"auto",datawidth:la(n,"width")||"auto"});m.remove();e.o&&e.o.remove()},ia=function(a,n,e){!0===n[0]&&(e="<span class='"+Q("fm-button-icon",e,n[2])+"'></span>",
"right"===n[1]?a.addClass("fm-button-icon-right").append(e):a.addClass("fm-button-icon-left").prepend(e))},ja=function(a){return"&nbsp;"===a||"&#160;"===a||1===a.length&&160===a.charCodeAt(0)};n.extend({searchGrid:function(g){return this.each(function(){function N(b){t("beforeShow",b)&&(a(A).data("onClose",c.onClose),n.viewModal(A,{gbox:D,jqm:c.jqModal,overlay:c.overlay,modal:c.modal,overlayClass:c.overlayClass,toTop:c.toTop,onHide:function(a){na.call(m,"searchProp",d,a)}}),t("afterShow",b))}var e=
this,m=a(e),k=e.p;if(e.grid&&null!=k){var c=a.extend(!0,{recreateFilter:!1,drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,searchOnEnter:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,removemodal:!0,resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,
stringResult:void 0,onClose:null,onSearch:null,onReset:null,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null,operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE","in":"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",nu:"IS NULL",nn:"IS NOT NULL"}},G.getGridRes.call(m,"search"),n.search||{},k.searching||{},g||{}),d="fbox_"+k.id,q=c.commonIconClass,l={themodal:"searchmod"+d,modalhead:"searchhd"+d,modalcontent:"searchcnt"+
d,resizeAlso:d},A="#"+F(l.themodal),D=k.gBox,f=k.gView,r=a.each,u=k.postData[c.sFilter],t=function(){var b=a.makeArray(arguments);b.unshift("Search");b.unshift("Filter");b.unshift(c);return ka.apply(e,b)};"string"===typeof u&&(u=""!==a.trim(u)?n.parse(u):void 0);!0===c.recreateFilter?a(A).remove():m.data("searchProp")&&a.extend(c,m.data("searchProp"));if(void 0!==a(A)[0])N(a("#fbox_"+k.idSel));else{var y=a("<div><div id='"+d+"' class='searchFilter' style='overflow:auto'></div></div>").insertBefore(f);
"rtl"===k.direction&&y.attr("dir","rtl");var K="",E="",b,x=!1,I,v=-1,C=a.extend([],k.colModel);I=L.call(e,d+"_search",c.Find,Q(q,c.findDialogIcon),"right");var B=L.call(e,d+"_reset",c.Reset,Q(q,c.resetDialogIcon),"left");c.showQuery&&(K=L.call(e,d+"_query","Query",Q(q,c.queryDialogIcon),"left")+"&#160;");c.searchForAdditionalProperties&&r(k.additionalProperties,function(){var a="string"===typeof this?{name:this}:this;a.label||(a.label=a.name);a.isAddProp=!0;C.push(a)});c.columns.length?(C=c.columns,
v=0,b=C[0].index||C[0].name):r(C,function(a,c){c.label||(c.label=c.isAddProp?c.name:k.colNames[a]);if(!x){var d=void 0===c.search?!0:c.search,f=!0===c.hidden;if(c.searchoptions&&!0===c.searchoptions.searchhidden&&d||d&&!f)x=!0,b=c.index||c.name,v=a}});if(!u&&b||!1===c.multipleSearch)q="eq",0<=v&&C[v].searchoptions&&C[v].searchoptions.sopt?q=C[v].searchoptions.sopt[0]:c.sopt&&c.sopt.length&&(q=c.sopt[0]),u={groupOp:"AND",rules:[{field:b,op:q,data:""}]};x=!1;c.tmplNames&&c.tmplNames.length&&(x=!0,E=
c.tmplLabel,E+="<select class='ui-template'>",E+="<option value='default'>Default</option>",r(c.tmplNames,function(a,b){E+="<option value='"+a+"'>"+b+"</option>"}),E+="</select>");I="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+d+"_2'><tbody><tr><td colspan='2'><hr class='"+X.call(e,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='EditButton EditButton-"+k.direction+"'  style='float:"+("rtl"===k.direction?"right":"left")+";'>"+B+E+"</td><td class='EditButton EditButton-"+
k.direction+"'>"+K+I+"</td></tr></tbody></table>";d=F(d);c.gbox="#gbox_"+d;c.height="auto";d="#"+d;a(d).jqFilter({columns:C,filter:c.loadDefaults?u:null,showQuery:c.showQuery,errorcheck:c.errorcheck,sopt:c.sopt,groupButton:c.multipleGroup,ruleButtons:c.multipleSearch,afterRedraw:c.afterRedraw,ops:c.odata,cops:k.customSortOperations,operands:c.operands,ajaxSelectOptions:k.ajaxSelectOptions,groupOps:c.groupOps,onChange:function(){this.p.showQuery&&a(".query",this).html(this.toUserFriendlyString());
ma.call(e,c.afterChange,"jqGridFilterAfterChange",a(d),c)},direction:k.direction,id:k.id});y.append(I);x&&c.tmplFilters&&c.tmplFilters.length&&a(".ui-template",y).bind("change",function(){var b=a(this).val();"default"===b?a(d).jqFilter("addFilter",u):a(d).jqFilter("addFilter",c.tmplFilters[parseInt(b,10)]);return!1});!0===c.multipleGroup&&(c.multipleSearch=!0);t("onInitialize",a(d));c.layer?n.createModal.call(e,l,y,c,f,a(D)[0],"#"+F(c.layer),{position:"relative"}):n.createModal.call(e,l,y,c,f,a(D)[0]);
(c.searchOnEnter||c.closeOnEscape)&&a(A).keydown(function(b){var f=a(b.target);if(!(!c.searchOnEnter||13!==b.which||f.hasClass("add-group")||f.hasClass("add-rule")||f.hasClass("delete-group")||f.hasClass("delete-rule")||f.hasClass("fm-button")&&f.is("[id$=_query]")))return a(d+"_search").click(),!1;if(c.closeOnEscape&&27===b.which)return a("#"+F(l.modalhead)).find(".ui-jqdialog-titlebar-close").click(),!1});K&&a(d+"_query").bind("click",function(){a(".queryresult",y).toggle();return!1});void 0===
c.stringResult&&(c.stringResult=c.multipleSearch);a(d+"_search").bind("click",function(){var b={},f,l,t=a(d);l=t.find(".input-elm");l.filter(":focus")&&(l=l.filter(":focus"));l.change();l=t.jqFilter("filterData");if(c.errorcheck&&(t[0].hideError(),c.showQuery||t.jqFilter("toSQLString"),t[0].p.error))return t[0].showError(),!1;if(c.stringResult||"local"===k.datatype){try{f=xmlJsonClass.toJson(l,"","",!1)}catch(g){try{f=JSON.stringify(l)}catch(q){}}"string"===typeof f&&(b[c.sFilter]=f,r([c.sField,c.sValue,
c.sOper],function(){b[this]=""}))}else c.multipleSearch?(b[c.sFilter]=l,r([c.sField,c.sValue,c.sOper],function(){b[this]=""})):(b[c.sField]=l.rules[0].field,b[c.sValue]=l.rules[0].data,b[c.sOper]=l.rules[0].op,b[c.sFilter]="");k.search=!0;a.extend(k.postData,b);ma.call(e,c.onSearch,"jqGridFilterSearch",k.filters)&&m.trigger("reloadGrid",[a.extend({page:1},c.reloadGridSearchOptions||{})]);c.closeAfterSearch&&n.hideModal(A,{gb:D,jqm:c.jqModal,onClose:c.onClose,removemodal:c.removemodal});return!1});
a(d+"_reset").bind("click",function(){var b={},f=a(d);k.search=!1;k.resetsearch=!0;!1===c.multipleSearch?b[c.sField]=b[c.sValue]=b[c.sOper]="":b[c.sFilter]="";f[0].resetFilter();x&&a(".ui-template",y).val("default");a.extend(k.postData,b);ma.call(e,c.onReset,"jqGridFilterReset")&&m.trigger("reloadGrid",[a.extend({page:1},c.reloadGridResetOptions||{})]);c.closeAfterReset&&n.hideModal(A,{gb:D,jqm:c.jqModal,onClose:c.onClose,removemodal:c.removemodal});return!1});N(a(d));var w=O.call(e,"hover");a(".fm-button:not(."+
O.call(e,"disabled").split(" ").join(".")+")",y).hover(function(){a(this).addClass(w)},function(){a(this).removeClass(w)})}}})},editGridRow:function(g,N){return this.each(function(){function e(){a(C+" > tbody > tr > td .FormElement").each(function(){var p=a(".customelement",this),c=this.name;if(p.length){if(c=p.attr("name"),p=Y[c],void 0!==p&&(p=S[p],p=p.editoptions||{},a.isFunction(p.custom_value))){try{if(h[c]=p.custom_value.call(r,a("#"+F(c),C),"get"),void 0===h[c])throw"e1";}catch(f){"e1"===f?
n.info_dialog.call(r,ea,"function 'custom_value' "+b.msg.novalue,b.bClose):n.info_dialog.call(r,ea,f.message,b.bClose)}return!0}}else switch(p=a(this)[0].type,p){case "checkbox":h[c]=a(this).is(":checked")?a(this).val():a(this).data("offval");break;case "select-one":h[c]=a("option:selected",this).val();break;case "select-multiple":h[c]=a(this).val();h[c]=h[c]?h[c].join(","):"";a("option:selected",this).each(function(b,p){a(p).text()});break;case "date":h[c]=a(this).val();3===String(h[c]).split("-").length&&
(p=Y[c],void 0!==p&&(p=S[p],p=p.formatoptions||{},p=p.newformat||K.call(u,"formatter.date.newformat"),h[c]=n.parseDate.call(u[0],"Y-m-d",h[c],p)));break;default:void 0!==p&&0>a.inArray(p,b.skipPostTypes)&&(h[c]=a(this).val())}});return!0}function m(p,c,h){var f=0,d=[],e=!1,l="",k;for(k=1;k<=h;k++)l+="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";"_empty"!==p&&(e=G.getInd.call(u,p));a(S).each(function(k){var m=this.name,g,q,B,u,w;g=this.editable;var z=!1,v=!1;w="_empty"===p?"addForm":
"editForm";a.isFunction(g)&&(g=g.call(r,{rowid:p,iCol:k,iRow:e,cmName:m,cm:this,mode:w}));u=(this.editrules&&!0===this.editrules.edithidden?0:!0===this.hidden||"hidden"===g)?"style='display:none'":"";switch(String(g).toLowerCase()){case "hidden":g=!0;break;case "disabled":z=g=!0;break;case "readonly":v=g=!0}if("cb"!==m&&"subgrid"!==m&&!0===g&&"rn"!==m){if(!1===e)B="";else{g=a(r.rows[e].cells[k]);try{B=a.unformat.call(r,g,{rowId:p,colModel:this},k)}catch(A){B=this.edittype&&"textarea"===this.edittype?
g.text():g.html()}ja(B)&&(B="")}g=a.extend({},this.editoptions||{},{id:m,name:m,rowId:p,mode:w});var y=a.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},this.formoptions||{}),P=parseInt(y.rowpos,10)||f+1,C=parseInt(2*(parseInt(y.colpos,10)||1),10);"_empty"===p&&g.defaultValue&&(B=a.isFunction(g.defaultValue)?g.defaultValue.call(r):g.defaultValue);this.edittype||(this.edittype="text");t.autoEncodeOnEdit&&(B=n.oldDecodePostedData(B));w=n.createEl.call(r,this.edittype,g,B,!1,a.extend({},
n.ajaxOptions,t.ajaxSelectOptions||{}));if(b.checkOnSubmit||b.checkOnUpdate)b._savedData[m]=B;a(w).addClass("FormElement");-1<a.inArray(this.edittype,["text","textarea","password","select"])&&a(w).addClass(X.call(r,"dialog.dataField"));q=a(c).find("tr[data-rowpos="+P+"]");if(y.rowabove){var H=a("<tr><td class='contentinfo' colspan='"+2*h+"'>"+y.rowcontent+"</td></tr>");a(c).append(H);H[0].rp=P}0===q.length&&(q=a("<tr "+u+" data-rowpos='"+P+"'></tr>").addClass("FormData").attr("id","tr_"+m),a(q).append(l),
a(c).append(q),q[0].rp=P);u=a("td:eq("+(C-2)+")",q[0]);q=a("td:eq("+(C-1)+")",q[0]);u.html(void 0===y.label?t.colNames[k]:y.label||"&#160;");q[ja(q.html())?"html":"append"](y.elmprefix).append(w).append(y.elmsuffix);z?(u.addClass(T),q.addClass(T),a(w).prop("readonly",!0),a(w).prop("disabled",!0)):v&&a(w).prop("readonly",!0);"custom"===this.edittype&&a.isFunction(g.custom_value)&&g.custom_value.call(r,a("#"+F(m),x),"set",B);n.bindEv.call(r,w,g);d[f]=k;f++}});0<f&&(k=a("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+
(2*h-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+y+"_id' value='"+p+"'/></td></tr>"),k[0].rp=f+999,a(c).append(k),b.checkOnSubmit||b.checkOnUpdate)&&(b._savedData[y+"_id"]=p);return d}function k(p,c){var h,f=0,d,e,l,k,g;if(b.checkOnSubmit||b.checkOnUpdate)b._savedData={},b._savedData[y+"_id"]=p;var m=t.colModel;if("_empty"===p)a(m).each(function(){h=this.name;l=a.extend({},this.editoptions||{});(e=a("#"+F(h),c))&&e.length&&null!==e[0]&&(k="","custom"===this.edittype&&
a.isFunction(l.custom_value)?l.custom_value.call(r,e,"set",k):l.defaultValue?(k=a.isFunction(l.defaultValue)?l.defaultValue.call(r):l.defaultValue,"checkbox"===e[0].type?(g=k.toLowerCase(),0>g.search(/(false|f|0|no|n|off|undefined)/i)&&""!==g?(e[0].checked=!0,e[0].defaultChecked=!0,e[0].value=k):(e[0].checked=!1,e[0].defaultChecked=!1)):e.val(k)):"checkbox"===e[0].type?(e[0].checked=!1,e[0].defaultChecked=!1,k=a(e).data("offval")):e[0].type&&"select"===e[0].type.substr(0,6)?e[0].selectedIndex=0:e.val(k),
!0===b.checkOnSubmit||b.checkOnUpdate)&&(b._savedData[h]=k)}),a("#id_g",c).val(p);else{var q=G.getInd.call(u,p,!0);q&&(a(q.cells).filter("td[role=gridcell]").each(function(e){h=m[e].name;if("cb"!==h&&"subgrid"!==h&&"rn"!==h&&!0===m[e].editable){try{d=a.unformat.call(r,a(this),{rowId:p,colModel:m[e]},e)}catch(l){d="textarea"===m[e].edittype?a(this).text():a(this).html()}t.autoEncodeOnEdit&&(d=n.oldDecodePostedData(d));if(!0===b.checkOnSubmit||b.checkOnUpdate)b._savedData[h]=d;h="#"+F(h);switch(m[e].edittype){case "password":case "text":case "button":case "image":case "textarea":ja(d)&&
(d="");a(h,c).val(d);break;case "select":var k=d.split(","),k=a.map(k,function(b){return a.trim(b)});a(h+" option",c).each(function(){var b=a(this),h=a.trim(b.val()),b=a.trim(b.text());m[e].editoptions.multiple||a.trim(d)!==b&&k[0]!==b&&k[0]!==h?m[e].editoptions.multiple?-1<a.inArray(b,k)||-1<a.inArray(h,k)?this.selected=!0:this.selected=!1:this.selected=!1:this.selected=!0});break;case "checkbox":d=String(d);if(m[e].editoptions&&m[e].editoptions.value)if(m[e].editoptions.value.split(":")[0]===d)a(h,
c)[M]({checked:!0,defaultChecked:!0});else a(h,c)[M]({checked:!1,defaultChecked:!1});else d=d.toLowerCase(),0>d.search(/(false|f|0|no|n|off|undefined)/i)&&""!==d?(a(h,c)[M]("checked",!0),a(h,c)[M]("defaultChecked",!0)):(a(h,c)[M]("checked",!1),a(h,c)[M]("defaultChecked",!1));break;case "custom":try{if(m[e].editoptions&&a.isFunction(m[e].editoptions.custom_value))m[e].editoptions.custom_value.call(r,a(h,c),"set",d);else throw"e1";}catch(l){"e1"===l?n.info_dialog.call(r,ea,"function 'custom_value' "+
b.msg.nodefined,b.bClose):n.info_dialog.call(r,ea,l.message,b.bClose)}}f++}}),0<f&&a("#id_g",C).val(p))}}function c(){var c=b.url||t.editurl;a.each(S,function(b,d){var f=d.name,e=h[f];"date"!==d.formatter||null!=d.formatoptions&&!0===d.formatoptions.sendFormatted||(h[f]=a.unformat.date.call(r,e,d));"clientArray"!==c&&d.editoptions&&!0===d.editoptions.NullIfEmpty&&h.hasOwnProperty(f)&&""===e&&(h[f]="null")})}function d(){var p=[!0,"",""],d={},f=t.prmNames,e,l,m,q,w,v,A=G.getInd.call(u,g),P=!1===A?
null:r.rows[A];(v=u.triggerHandler("jqGridAddEditBeforeCheckValues",[a(x),J]))&&"object"===typeof v&&(h=v);A=!1===A?-1:A;a.isFunction(b.beforeCheckValues)&&(v=b.beforeCheckValues.call(r,h,a(x),J))&&"object"===typeof v&&(h=v);for(m in h)if(h.hasOwnProperty(m)&&(v=t.iColByName[m],p=n.checkValues.call(r,h[m],m,void 0,void 0,{oldValue:"_empty"===g?null:G.getCell.call(u,g,v),newValue:h[m],cmName:m,rowid:g,cm:S[v],iCol:v,iRow:A,tr:P,td:null==P?null:P.cells[v],mode:"_empty"===g?"addForm":"editForm"}),!1===
p[0]))break;c();p[0]&&(d=u.triggerHandler("jqGridAddEditClickSubmit",[b,h,J]),void 0===d&&a.isFunction(b.onclickSubmit)&&(d=b.onclickSubmit.call(r,b,h,J)||{}),p=u.triggerHandler("jqGridAddEditBeforeSubmit",[h,a(x),J]),null==p&&(p=[!0,"",""]),p[0]&&a.isFunction(b.beforeSubmit)&&(p=b.beforeSubmit.call(r,h,a(x),J),null==p&&(p=[!0,"",""])));if(p[0]&&!b.processing){b.processing=!0;a("#sData",B).addClass(ra);m=b.url||t.editurl;l=f.oper;e="clientArray"===m&&!1!==t.keyName?t.keyName:f.id;h[l]="_empty"===
a.trim(h[y+"_id"])?f.addoper:f.editoper;h[l]!==f.addoper?h[e]=h[y+"_id"]:void 0===h[e]&&(h[e]=h[y+"_id"]);delete h[y+"_id"];h=a.extend(h,b.editData,d);if(!0===t.treeGrid)for(w in h[l]===f.addoper&&(q=t.selrow,h["adjacency"===t.treeGridModel?t.treeReader.parent_id_field:"parent_id"]=q),t.treeReader)t.treeReader.hasOwnProperty(w)&&(d=t.treeReader[w],!h.hasOwnProperty(d)||h[l]===f.addoper&&"parent_id_field"===w||delete h[d]);h[e]=n.stripPref(t.idPrefix,h[e]);t.autoEncodeOnEdit&&a.each(h,function(b,c){a.isFunction(c)||
(h[b]=n.oldEncodePostedData(c))});w=a.extend({url:a.isFunction(m)?m.call(r,h[e],J,h,b):m,type:a.isFunction(b.mtype)?b.mtype.call(r,J,b,h[e],h):b.mtype,data:n.serializeFeedback.call(r,a.isFunction(b.serializeEditData)?b.serializeEditData:t.serializeEditData,"jqGridAddEditSerializeEditData",h),complete:function(c,d){a("#sData",B).removeClass(ra);h[e]=t.idPrefix+a("#id_g",C).val();300<=c.status&&304!==c.status||0===c.status&&4===c.readyState?(p[0]=!1,p[1]=u.triggerHandler("jqGridAddEditErrorTextFormat",
[c,J]),a.isFunction(b.errorTextFormat)?p[1]=b.errorTextFormat.call(r,c,J):p[1]=d+" Status: '"+c.statusText+"'. Error code: "+c.status):(p=u.triggerHandler("jqGridAddEditAfterSubmit",[c,h,J]),null==p&&(p=[!0,"",""]),p[0]&&a.isFunction(b.afterSubmit)&&(p=b.afterSubmit.call(r,c,h,J),null==p&&(p=[!0,"",""])));if(!1===p[0])a("#FormError>td",C).html(p[1]),a("#FormError",C).show();else{t.autoEncodeOnEdit&&a.each(h,function(a,b){h[a]=n.oldDecodePostedData(b)});var m=[a.extend({},b.reloadGridOptions||{})];
h[l]===f.addoper?(p[2]||(p[2]=n.randId()),null==h[e]||"_empty"===h[e]||h[l]===f.addoper?h[e]=p[2]:p[2]=h[e],b.reloadAfterSubmit?u.trigger("reloadGrid",m):!0===t.treeGrid?G.addChildNode.call(u,p[2],q,h):G.addRowData.call(u,p[2],h,b.addedrow),b.closeAfterAdd?(!0!==t.treeGrid&&E.call(u,p[2]),U(z,{gb:H,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form})):b.clearAfterAdd&&k("_empty",x)):(b.reloadAfterSubmit?(u.trigger("reloadGrid",m),b.closeAfterEdit||setTimeout(function(){E.call(u,
h[e])},1E3)):!0===t.treeGrid?G.setTreeRow.call(u,h[e],h):G.setRowData.call(u,h[e],h),b.closeAfterEdit&&U(z,{gb:H,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form}));if(a.isFunction(b.afterComplete)){var g=c;setTimeout(function(){u.triggerHandler("jqGridAddEditAfterComplete",[g,h,a(x),J]);b.afterComplete.call(r,g,h,a(x),J);g=null},50)}if(b.checkOnSubmit||b.checkOnUpdate)if(a(x).data("disabled",!1),"_empty"!==b._savedData[y+"_id"])for(var w in b._savedData)b._savedData.hasOwnProperty(w)&&
h[w]&&(b._savedData[w]=h[w])}b.processing=!1;try{a(":input:visible",x)[0].focus()}catch(v){}}},n.ajaxOptions,b.ajaxEditOptions);w.url||b.useDataProxy||(a.isFunction(t.dataProxy)?b.useDataProxy=!0:(p[0]=!1,p[1]+=" "+n.errors.nourl));p[0]&&(b.useDataProxy?(d=t.dataProxy.call(r,w,"set_"+y),void 0===d&&(d=[!0,""]),!1===d[0]?(p[0]=!1,p[1]=d[1]||"Error deleting the selected row!"):(w.data.oper===f.addoper&&b.closeAfterAdd&&U(z,{gb:H,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,
form:b.form}),w.data.oper===f.editoper&&b.closeAfterEdit&&U(z,{gb:H,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form}))):"clientArray"===w.url?(b.reloadAfterSubmit=!1,h=w.data,w.complete({status:200,statusText:""},"")):a.ajax(w))}!1===p[0]&&(a("#FormError>td",C).html(p[1]),a("#FormError",C).show())}function q(a,b){var c=!1,h;for(h in a)if(a.hasOwnProperty(h)&&String(a[h])!==String(b[h])){c=!0;break}return c}function l(){var c=!0;a("#FormError",C).hide();
b.checkOnUpdate&&(h={},e(),P=q(h,b._savedData))&&(a(x).data("disabled",!0),a(".confirm",z).show(),c=!1);return c}function A(){var b=n.detectRowEditing.call(r,g);if(null!=b)if("inlineEditing"===b.mode)G.restoreRow.call(u,g);else{var b=b.savedRow,c=r.rows[b.id];G.restoreCell.call(u,b.id,b.ic);a(c.cells[b.ic]).removeClass("edit-cell "+sa);a(c).addClass(sa).attr({"aria-selected":"true",tabindex:"0"})}}function D(b,c){var h=c[1].length-1;0===b?a("#pData",B).addClass(T):void 0!==c[1][b-1]&&R(a("#"+F(c[1][b-
1])),T)?a("#pData",B).addClass(T):a("#pData",B).removeClass(T);b===h?a("#nData",B).addClass(T):void 0!==c[1][b+1]&&R(a("#"+F(c[1][b+1])),T)?a("#nData",B).addClass(T):a("#nData",B).removeClass(T)}function f(){var b=G.getDataIDs.call(u),c=a("#id_g",C).val();return[a.inArray(c,b),b]}var r=this,u=a(r),t=r.p;if(r.grid&&null!=t&&g){var y=t.id,K=G.getGridRes,E=G.setSelection,b=a.extend(!0,{top:0,left:0,width:300,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,
closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:!1,closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0,overlayClass:"ui-widget-overlay",
removemodal:!0,skipPostTypes:["image","file"],form:"edit"},K.call(u,"edit"),n.edit,t.formEditing||{},N||{}),x="FrmGrid_"+y,I=x,v="TblGrid_"+y,C="#"+F(v),B=C+"_2",w={themodal:"editmod"+y,modalhead:"edithd"+y,modalcontent:"editcnt"+y,resizeAlso:x},z="#"+F(w.themodal),H=t.gBox,M=t.propOrAttr,S=t.colModel,Y=t.iColByName,Z=1,aa=0,h,P,J,fa=b.commonIconClass,U=n.hideModal,ea=K.call(u,"errors.errcap"),V=function(){var c=a.makeArray(arguments);c.unshift("");c.unshift("AddEdit");c.unshift(b);return ka.apply(r,
c)},ba=O.call(r,"hover"),T=O.call(r,"disabled"),sa=O.call(r,"select"),ra=O.call(r,"active"),W=O.call(r,"error"),x="#"+F(x);"new"===g?(g="_empty",J="add",b.caption=b.addCaption):(b.caption=b.editCaption,J="edit");if(!b.recreateForm){var ca=u.data("formProp");ca&&(ca.top=Math.max(ca.top,0),ca.left=Math.max(ca.left,0),a.extend(b,ca))}ca=!0;!b.checkOnUpdate||!0!==b.jqModal&&void 0!==b.jqModal||b.modal||(ca=!1);var ga=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px",da=isNaN(b.datawidth)?b.datawidth:
b.datawidth+"px",I=a("<form name='FormPost' id='"+I+"' class='FormGrid' onSubmit='return false;' style='width:"+da+";overflow:auto;position:relative;height:"+ga+";'></form>").data("disabled",!1),ha=a("<table id='"+v+"' class='EditTable'"+(n.msie&&8>n.msiever()?" cellspacing='0'":"")+"><tbody></tbody></table>");a(S).each(function(){var a=this.formoptions;Z=Math.max(Z,a?a.colpos||0:0);aa=Math.max(aa,a?a.rowpos||0:0)});a(I).append(ha);W=a("<tr id='FormError' style='display:none'><td class='"+W+"' colspan='"+
2*Z+"'>&#160;</td></tr>");W[0].rp=0;a(ha).append(W);W=a("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+2*Z+"'>"+(b.topinfo||"&#160;")+"</td></tr>");W[0].rp=0;a(ha).append(W);if(V("beforeInitData",I,J)){A();ga=(W="rtl"===t.direction?!0:!1)?"nData":"pData";da=W?"pData":"nData";m(g,ha,Z);var ga=L.call(r,ga,"",Q(fa,b.prevIcon),"","left"),da=L.call(r,da,"",Q(fa,b.nextIcon),"","right"),oa=L.call(r,"sData",b.bSubmit),pa=L.call(r,"cData",b.bCancel),v="<table"+(n.msie&&8>n.msiever()?
" cellspacing='0'":"")+" class='EditTable' id='"+v+"_2'><tbody><tr><td colspan='2'><hr class='"+X.call(r,"dialog.hr")+"' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton navButton-"+t.direction+"'>"+(W?da+ga:ga+da)+"</td><td class='EditButton EditButton-"+t.direction+"'>"+oa+"&#160;"+pa+"</td></tr>",v=v+("<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+(b.bottominfo||"&#160;")+"</td></tr>"),v=v+"</tbody></table>";if(0<aa){var qa=[];a.each(a(ha)[0].rows,
function(a,b){qa[a]=b});qa.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0});a.each(qa,function(b,c){a("tbody",ha).append(c)})}b.gbox=H;var ta=!1;!0===b.closeOnEscape&&(b.closeOnEscape=!1,ta=!0);v=a("<div></div>").append(I).append(v);n.createModal.call(r,w,v,b,t.gView,a(H)[0]);b.topinfo&&a(".tinfo",C).show();b.bottominfo&&a(".binfo",B).show();v=v=null;a(z).keydown(function(c){var h=(c.target.tagName||"").toUpperCase(),d,e;if(!0===a(x).data("disabled"))return!1;if(13===c.which&&"TEXTAREA"!==h){d=
a(B).find(":focus");e=d.attr("id");if(0<d.length&&0<=a.inArray(e,["pData","nData","cData"]))return d.trigger("click"),!1;if(!0===b.savekey[0]&&13===b.savekey[1])return a("#sData",B).trigger("click"),!1}if(!0===b.savekey[0]&&c.which===b.savekey[1]&&"TEXTAREA"!==h)return a("#sData",B).trigger("click"),!1;if(27===c.which){if(!l())return!1;ta&&U(z,{gb:b.gbox,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form});return!1}if(!0===b.navkeys[0]){if("_empty"===a("#id_g",
C).val())return!0;if(c.which===b.navkeys[1])return a("#pData",B).trigger("click"),!1;if(c.which===b.navkeys[2])return a("#nData",B).trigger("click"),!1}});b.checkOnUpdate&&(a("a.ui-jqdialog-titlebar-close span",z).removeClass("jqmClose"),a("a.ui-jqdialog-titlebar-close",z).unbind("click").click(function(){if(!l())return!1;U(z,{gb:H,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form});return!1}));ia(a("#sData",B),b.saveicon,fa);ia(a("#cData",B),b.closeicon,
fa);if(b.checkOnSubmit||b.checkOnUpdate)oa=L.call(r,"sNew",b.bYes),da=L.call(r,"nNew",b.bNo),pa=L.call(r,"cNew",b.bExit),w=b.zIndex||999,w++,a("<div class='"+b.overlayClass+" jqgrid-overlay confirm' style='z-index:"+w+";display:none;'>&#160;</div><div class='"+X.call(r,"dialog.content","confirm ui-jqconfirm")+"' style='z-index:"+(w+1)+"'>"+b.saveData+"<br/><br/>"+oa+da+pa+"</div>").insertAfter(x),a("#sNew",z).click(function(){d();a(x).data("disabled",!1);a(".confirm",z).hide();return!1}),a("#nNew",
z).click(function(){a(".confirm",z).hide();a(x).data("disabled",!1);setTimeout(function(){a(":input:visible",x)[0].focus()},0);return!1}),a("#cNew",z).click(function(){a(".confirm",z).hide();a(x).data("disabled",!1);U(z,{gb:H,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form});return!1});V("onInitializeForm",a(x),J);"_empty"!==g&&b.viewPagerButtons?a("#pData,#nData",B).show():a("#pData,#nData",B).hide();V("beforeShowForm",a(x),J);a(z).data("onClose",b.onClose);
n.viewModal(z,{gbox:H,jqm:b.jqModal,overlay:b.overlay,modal:b.modal,overlayClass:b.overlayClass,toTop:b.toTop,onHide:function(a){na.call(u,"formProp",x,a)}});ca||a("."+F(b.overlayClass)).click(function(){if(!l())return!1;U(z,{gb:H,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form});return!1});a(".fm-button",z).hover(function(){a(this).addClass(ba)},function(){a(this).removeClass(ba)});a("#sData",B).click(function(){h={};a("#FormError",C).hide();e();"_empty"===
h[y+"_id"]?d():!0===b.checkOnSubmit?(P=q(h,b._savedData))?(a(x).data("disabled",!0),a(".confirm",z).show()):d():d();return!1});a("#cData",B).click(function(){if(!l())return!1;U(z,{gb:H,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form});return!1});a("#nData",B).click(function(){if(!l())return!1;a("#FormError",C).hide();var b=f();b[0]=parseInt(b[0],10);if(-1!==b[0]&&b[1][b[0]+1]){if(!V("onclickPgButtons","next",a(x),b[1][b[0]]))return!1;k(b[1][b[0]+1],x);
E.call(u,b[1][b[0]+1]);V("afterclickPgButtons","next",a(x),b[1][b[0]+1]);D(b[0]+1,b)}return!1});a("#pData",B).click(function(){if(!l())return!1;a("#FormError",C).hide();var b=f();if(-1!==b[0]&&b[1][b[0]-1]){if(!V("onclickPgButtons","prev",a(x),b[1][b[0]])||R(a("#"+F(b[1][b[0]-1])),T))return!1;k(b[1][b[0]-1],x);E.call(u,b[1][b[0]-1]);V("afterclickPgButtons","prev",a(x),b[1][b[0]-1]);D(b[0]-1,b)}return!1});V("afterShowForm",a(x),J);w=f();D(w[0],w)}}})},viewGridRow:function(g,N){return this.each(function(){function e(){!0!==
f.closeOnEscape&&!0!==f.navkeys[0]||setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+F(b.modalhead)).attr("tabindex","-1").focus()},0)}function m(b,c,d){var e,m,k,g=0,w,r,t=[],B=G.getInd.call(l,b),u;u=X.call(q,"dialog.viewData","DataTD form-view-data");var z=X.call(q,"dialog.viewLabel","CaptionTD form-view-label"),y="<td class='"+z+"' width='"+f.labelswidth+"'>&#160;</td><td class='"+u+" ui-helper-reset'>&#160;</td>",x="",z="<td class='"+z+"'></td><td class='"+u+"'></td>",C=["integer","number",
"currency"],H=0,D=0,E,F,p;for(u=1;u<=d;u++)x+=1===u?y:z;a(v).each(function(){(m=this.editrules&&!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1)||"right"!==this.align||(this.formatter&&-1!==a.inArray(this.formatter,C)?H=Math.max(H,parseInt(this.width,10)):D=Math.max(D,parseInt(this.width,10)))});E=0!==H?H:0!==D?D:0;a(v).each(function(b){e=this.name;F=!1;r=(m=this.editrules&&!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1)?"style='display:none'":"";p="boolean"!==typeof this.viewable?
!0:this.viewable;if("cb"!==e&&"subgrid"!==e&&"rn"!==e&&p){w=!1===B?"":n.getDataFieldOfCell.call(q,q.rows[B],b).html();F="right"===this.align&&0!==E?!0:!1;var h=a.extend({},{rowabove:!1,rowcontent:""},this.formoptions||{}),f=parseInt(h.rowpos,10)||g+1,l=parseInt(2*(parseInt(h.colpos,10)||1),10);if(h.rowabove){var u=a("<tr><td class='contentinfo' colspan='"+2*d+"'>"+h.rowcontent+"</td></tr>");a(c).append(u);u[0].rp=f}k=a(c).find("tr[data-rowpos="+f+"]");0===k.length&&(k=a("<tr "+r+" data-rowpos='"+
f+"'></tr>").addClass("FormData").attr("id","trv_"+e),a(k).append(x),a(c).append(k),k[0].rp=f);h=void 0===h.label?A.colNames[b]:h.label;f=a("td:eq("+(l-1)+")",k[0]);a("td:eq("+(l-2)+")",k[0]).html("<b>"+(h||"&nbsp;")+"</b>");f[ja(f.html())?"html":"append"]("<span>"+(w||"&nbsp;")+"</span>").attr("id","v_"+e);F&&a("td:eq("+(l-1)+") span",k[0]).css({"text-align":"right",width:E+"px"});t[g]=b;g++}});0<g&&(b=a("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*
d-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+b+"'/></td></tr>"),b[0].rp=g+99,a(c).append(b));return t}function k(b){var c,d,e=0,f=G.getInd.call(l,b,!0),k;f&&(a("td",f).each(function(b){k=v[b];c=k.name;d=k.editrules&&!0===k.editrules.edithidden?!1:!0===k.hidden?!0:!1;"cb"!==c&&"subgrid"!==c&&"rn"!==c&&(c=F("v_"+c),a("#"+c+" span",u).html(n.getDataFieldOfCell.call(q,f,b).html()),d&&a("#"+c,u).parents("tr:first").hide(),e++)}),0<e&&a("#id_g",u).val(b))}function c(b,
c){var d=c[1].length-1;0===b?a("#pData",t).addClass(H):void 0!==c[1][b-1]&&R(a("#"+F(c[1][b-1])),H)?a("#pData",t).addClass(H):a("#pData",t).removeClass(H);b===d?a("#nData",t).addClass(H):void 0!==c[1][b+1]&&R(a("#"+F(c[1][b+1])),H)?a("#nData",t).addClass(H):a("#nData",t).removeClass(H)}function d(){var b=G.getDataIDs.call(l),c=a("#id_g",u).val();return[a.inArray(c,b),b]}var q=this,l=a(q),A=q.p;if(q.grid&&null!=A&&g){var D=A.id,f=a.extend(!0,{top:0,left:0,width:0,datawidth:"auto",height:"auto",dataheight:"auto",
drag:!0,resize:!0,closeOnEscape:!1,labelswidth:"30%",navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0,recreateForm:!1,removemodal:!0,form:"view"},G.getGridRes.call(l,"view"),n.view||{},A.formViewing||{},N||{}),r="#ViewGrid_"+F(D),u="#ViewTbl_"+F(D),t=u+"_2",y="ViewGrid_"+D,K="ViewTbl_"+D,E=f.commonIconClass,b={themodal:"viewmod"+D,modalhead:"viewhd"+D,modalcontent:"viewcnt"+D,resizeAlso:y},x="#"+F(b.themodal),I=A.gBox,v=A.colModel,C=1,B=0,w=function(){var b=
a.makeArray(arguments);b.unshift("");b.unshift("View");b.unshift(f);return ka.apply(q,b)},z=O.call(q,"hover"),H=O.call(q,"disabled");f.recreateForm||l.data("viewProp")&&a.extend(f,l.data("viewProp"));var D=isNaN(f.dataheight)?f.dataheight:f.dataheight+"px",M=isNaN(f.datawidth)?f.datawidth:f.datawidth+"px",y=a("<form name='FormPost' id='"+y+"' class='FormGrid' style='width:"+M+";overflow:auto;position:relative;height:"+D+";'></form>"),S=a("<table id='"+K+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");
a(v).each(function(){var a=this.formoptions;C=Math.max(C,a?a.colpos||0:0);B=Math.max(B,a?a.rowpos||0:0)});y.append(S);if(w("beforeInitData",y)){m(g,S,C);var Y=(D="rtl"===A.direction?!0:!1)?"pData":"nData",M=L.call(q,D?"nData":"pData","",Q(E,f.prevIcon),"","left"),Y=L.call(q,Y,"",Q(E,f.nextIcon),"","right"),Z=L.call(q,"cData",f.bClose);if(0<B){var aa=[];a.each(a(S)[0].rows,function(a,b){aa[a]=b});aa.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0});a.each(aa,function(b,c){a("tbody",S).append(c)})}f.gbox=
I;K=a("<div></div>").append(y).append("<table border='0' class='EditTable' id='"+K+"_2'><tbody><tr id='Act_Buttons'><td class='navButton navButton-"+A.direction+"' width='"+(f.labelswidth||"auto")+"'>"+(D?Y+M:M+Y)+"</td><td class='EditButton EditButton-"+A.direction+"'>"+Z+"</td></tr></tbody></table>");n.createModal.call(q,b,K,f,A.gView,a(A.gView)[0]);f.viewPagerButtons||a("#pData, #nData",t).hide();K=null;a(x).keydown(function(b){var c,d;if(!0===a(r).data("disabled"))return!1;if(13===b.which&&(c=
a(t).find(":focus"),d=c.attr("id"),0<c.length&&0<=a.inArray(d,["pData","nData","cData"])))return c.trigger("click"),!1;if(27===b.which)return f.closeOnEscape&&n.hideModal(x,{gb:I,jqm:f.jqModal,onClose:f.onClose,removemodal:f.removemodal,formprop:!f.recreateForm,form:f.form}),!1;if(!0===f.navkeys[0]){if(b.which===f.navkeys[1])return a("#pData",t).trigger("click"),!1;if(b.which===f.navkeys[2])return a("#nData",t).trigger("click"),!1}});ia(a("#cData",t),f.closeicon,E);w("beforeShowForm",a(r));n.viewModal(x,
{gbox:I,jqm:f.jqModal,overlay:f.overlay,toTop:f.toTop,modal:f.modal,onHide:function(a){na.call(l,"viewProp",r,a)}});a(".fm-button:not(."+H.split(" ").join(".")+")",t).hover(function(){a(this).addClass(z)},function(){a(this).removeClass(z)});e();a("#cData",t).click(function(){n.hideModal(x,{gb:I,jqm:f.jqModal,onClose:f.onClose,removemodal:f.removemodal,formprop:!f.recreateForm,form:f.form});return!1});a("#nData",t).click(function(){a("#FormError",u).hide();var b=d();b[0]=parseInt(b[0],10);if(-1!==
b[0]&&b[1][b[0]+1]){if(!w("onclickPgButtons","next",a(r),b[1][b[0]]))return!1;k(b[1][b[0]+1]);G.setSelection.call(l,b[1][b[0]+1]);w("afterclickPgButtons","next",a(r),b[1][b[0]+1]);c(b[0]+1,b)}e();return!1});a("#pData",t).click(function(){a("#FormError",u).hide();var b=d();if(-1!==b[0]&&b[1][b[0]-1]){if(!w("onclickPgButtons","prev",a(r),b[1][b[0]]))return!1;k(b[1][b[0]-1]);G.setSelection.call(l,b[1][b[0]-1]);w("afterclickPgButtons","prev",a(r),b[1][b[0]-1]);c(b[0]-1,b)}e();return!1});E=d();c(E[0],
E)}}})},delGridRow:function(g,N){return this.each(function(){var e=this,m=e.p,k=a(e);if(e.grid&&null!=m&&g){var c=m.id,d=a.extend(!0,{top:0,left:0,width:240,removemodal:!0,height:"auto",dataheight:"auto",drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,closeOnEscape:!1,delData:{},onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},G.getGridRes.call(k,
"del"),n.del||{},m.formDeleting||{},N||{}),q="DelTbl_"+c,l="#DelTbl_"+F(c),A,D,f,r,u={themodal:"delmod"+c,modalhead:"delhd"+c,modalcontent:"delcnt"+c,resizeAlso:q},t="#"+F(u.themodal),y=m.gBox,K=d.commonIconClass,E=function(){var b=a.makeArray(arguments);b.unshift("");b.unshift("Delete");b.unshift(d);return ka.apply(e,b)},b=O.call(e,"hover"),x=O.call(e,"active"),I=O.call(e,"error");a.isArray(g)||(g=[String(g)]);if(void 0!==a(t)[0]){if(!E("beforeInitData",a(l)))return;a("#DelData>td",l).text(g.join()).data("rowids",
g);a("#DelError",l).hide();!0===d.processing&&(d.processing=!1,a("#dData",l).removeClass(x));E("beforeShowForm",a(l));n.viewModal(t,{gbox:y,jqm:d.jqModal,jqM:!1,overlay:d.overlay,toTop:d.toTop,modal:d.modal})}else{var v=isNaN(d.dataheight)?d.dataheight:d.dataheight+"px",C=isNaN(d.datawidth)?d.datawidth:d.datawidth+"px",v="<div id='"+q+"' class='formdata' style='width:"+C+";overflow:auto;position:relative;height:"+v+";'><table class='DelTable'><tbody>",v=v+("<tr id='DelError' style='display:none'><td class='"+
I+"'></td></tr>"),v=v+("<tr id='DelData' style='display:none'><td >"+g.join()+"</td></tr>"),v=v+("<tr><td class='delmsg' style='white-space:pre;'>"+d.msg+"</td></tr><tr><td >&#160;</td></tr>"),v=v+"</tbody></table></div>",I=L.call(e,"dData",d.bSubmit),C=L.call(e,"eData",d.bCancel),v=v+("<table"+(n.msie&&8>n.msiever()?" cellspacing='0'":"")+" class='EditTable' id='"+q+"_2'><tbody><tr><td><hr class='"+X.call(e,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton EditButton-"+
m.direction+"'>"+I+"&#160;"+C+"</td></tr></tbody></table>");d.gbox=y;n.createModal.call(e,u,v,d,m.gView,a(m.gView)[0]);a("#DelData>td",l).data("rowids",g);if(!E("beforeInitData",a(v)))return;a(".fm-button",l+"_2").hover(function(){a(this).addClass(b)},function(){a(this).removeClass(b)});ia(a("#dData",l+"_2"),d.delicon,K);ia(a("#eData",l+"_2"),d.cancelicon,K);a("#dData",l+"_2").click(function(){var b=[!0,""],g,q=a("#DelData>td",l),u=q.text(),v=q.data("rowids"),q={};a.isFunction(d.onclickSubmit)&&(q=
d.onclickSubmit.call(e,d,u)||{});a.isFunction(d.beforeSubmit)&&(b=d.beforeSubmit.call(e,u)||b);if(b[0]&&!d.processing){d.processing=!0;f=m.prmNames;A=a.extend({},d.delData,q);r=f.oper;A[r]=f.deloper;D=f.id;u=v.slice();if(!u.length)return!1;for(g in u)u.hasOwnProperty(g)&&(u[g]=n.stripPref(m.idPrefix,u[g]));A[D]=u.join();a(this).addClass(x);g=d.url||m.editurl;g=a.extend({url:a.isFunction(g)?g.call(e,A[D],A,d):g,type:d.mtype,data:a.isFunction(d.serializeDelData)?d.serializeDelData.call(e,A):A,complete:function(c,
f){var g;a("#dData",l+"_2").removeClass(x);300<=c.status&&304!==c.status||0===c.status&&4===c.readyState?(b[0]=!1,a.isFunction(d.errorTextFormat)?b[1]=d.errorTextFormat.call(e,c):b[1]=f+" Status: '"+c.statusText+"'. Error code: "+c.status):a.isFunction(d.afterSubmit)&&(b=d.afterSubmit.call(e,c,A)||[!0]);if(!1===b[0])a("#DelError>td",l).html(b[1]),a("#DelError",l).show();else{if(d.reloadAfterSubmit&&"local"!==m.datatype)k.trigger("reloadGrid",[a.extend({},d.reloadGridOptions||{})]);else if(!0===m.treeGrid)try{G.delTreeNode.call(k,
v[0])}catch(q){}else for(v=v.slice(),g=0;g<v.length;g++)G.delRowData.call(k,v[g]);setTimeout(function(){E("afterComplete",c,u,a(l))},50)}d.processing=!1;b[0]&&n.hideModal(t,{gb:y,jqm:d.jqModal,onClose:d.onClose,removemodal:d.removemodal})}},n.ajaxOptions,d.ajaxDelOptions);g.url||d.useDataProxy||(a.isFunction(m.dataProxy)?d.useDataProxy=!0:(b[0]=!1,b[1]+=" "+n.errors.nourl));b[0]&&(d.useDataProxy?(g=m.dataProxy.call(e,g,"del_"+c),void 0===g&&(g=[!0,""]),!1===g[0]?(b[0]=!1,b[1]=g[1]||"Error deleting the selected row!"):
n.hideModal(t,{gb:y,jqm:d.jqModal,onClose:d.onClose,removemodal:d.removemodal})):"clientArray"===g.url?(A=g.data,g.complete({status:200,statusText:""},"")):a.ajax(g))}!1===b[0]&&(a("#DelError>td",l).html(b[1]),a("#DelError",l).show());return!1});a("#eData",l+"_2").click(function(){n.hideModal(t,{gb:y,jqm:d.jqModal,onClose:d.onClose,removemodal:d.removemodal});return!1});E("beforeShowForm",a(l));n.viewModal(t,{gbox:y,jqm:d.jqModal,overlay:d.overlay,toTop:d.toTop,modal:d.modal})}E("afterShowForm",a(l));
!0===d.closeOnEscape&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+F(u.modalhead)).attr("tabindex","-1").focus()},0)}})},navGrid:function(g,N,e,m,k,c,d){"object"===typeof g&&(d=c,c=k,k=m,m=e,e=N,N=g,g=void 0);m=m||{};e=e||{};d=d||{};k=k||{};c=c||{};return this.each(function(){var q=this,l=q.p,A=a(q);if(q.grid&&null!=l&&!(q.nav&&0<a(g).find(".navtable").length)){var D=l.id,f=a.extend({edit:!0,add:!0,del:!0,search:!0,refresh:!0,refreshstate:"firstpage",view:!1,closeOnEscape:!0,beforeRefresh:null,
afterRefresh:null,cloneToTop:!1,hideEmptyPagerParts:!0,alertwidth:200,alertheight:"auto",alerttop:null,removemodal:!0,alertleft:null,alertzIndex:null,iconsOverText:!1},G.getGridRes.call(A,"nav"),n.nav||{},l.navOptions||{},N||{});f.position=f.position||("rtl"===l.direction?"right":"left");var r,u=l.idSel,t=l.gBox,y=f.commonIconClass,K={themodal:"alertmod_"+D,modalhead:"alerthd_"+D,modalcontent:"alertcnt_"+D},E=function(){return function(){var b=document.documentElement,c=window,d=1024,e=768,h=A.closest(".ui-jqgrid").offset();
void 0===a("#"+F(K.themodal))[0]&&(f.alerttop||f.alertleft||(void 0!==c.innerWidth?(d=c.innerWidth,e=c.innerHeight):null!=b&&void 0!==b.clientWidth&&0!==b.clientWidth&&(d=b.clientWidth,e=b.clientHeight),d=d/2-parseInt(f.alertwidth,10)/2-h.left,e=e/2-25-h.top),n.createModal.call(q,K,"<div>"+f.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='"+D+"_jqg_alrt'></span></span>",{gbox:t,jqModal:f.jqModal,drag:!0,resize:!0,caption:f.alertcap,top:null!=f.alerttop?f.alerttop:e,left:null!=f.alertleft?
f.alertleft:d,width:f.alertwidth,height:f.alertheight,closeOnEscape:f.closeOnEscape,zIndex:f.alertzIndex,removemodal:f.removemodal},l.gView,a(t)[0],!1));n.viewModal("#"+F(K.themodal),{gbox:t,toTop:f.alertToTop,jqm:f.jqModal});var g=a("#"+F(K.modalhead)).find(".ui-jqdialog-titlebar-close");g.attr({tabindex:"0",href:"#",role:"button"});setTimeout(function(){g.focus()},50)}}(),b,x=function(b){if(13===b.which&&(b=a(this).find(".ui-pg-button").filter(":focus"),0<b.length))return b.trigger("click"),!1},
I=O.call(q,"hover"),v=O.call(q,"disabled");if(q.grid){q.modalAlert=E;void 0===g&&(l.pager?(g=l.pager,l.toppager&&(f.cloneToTop=!0)):l.toppager&&(g=l.toppager));var C=1,B,w,z,H,M,L=["left","center","right"],Y="<div class='ui-pg-button "+v+"'><span class='ui-separator'></span></div>",Z=function(){R(this,v)||a(this).addClass(I)},aa=function(){a(this).removeClass(I)},h=function(){R(this,v)||(a.isFunction(f.addfunc)?f.addfunc.call(q):G.editGridRow.call(A,"new",m));return!1},P=function(b,c,d){if(!R(this,
v)){var e=l.selrow;e?a.isFunction(b)?b.call(q,e):G[c].call(A,e,d):E()}return!1},J=function(){return P.call(this,f.editfunc,"editGridRow",e)},fa=function(){return P.call(this,f.viewfunc,"viewGridRow",d)},U=function(){var b;R(this,v)||(l.multiselect?(b=l.selarrrow,0===b.length&&(b=null)):b=l.selrow,b?a.isFunction(f.delfunc)?f.delfunc.call(q,b):G.delGridRow.call(A,b,k):E());return!1},ea=function(){R(this,v)||(a.isFunction(f.searchfunc)?f.searchfunc.call(q,c):G.searchGrid.call(A,c));return!1},V=function(){if(!R(this,
v)){a.isFunction(f.beforeRefresh)&&f.beforeRefresh.call(q);l.search=!1;l.resetsearch=!0;try{if("currentfilter"!==f.refreshstate){l.postData.filters="";try{a("#fbox_"+u).jqFilter("resetFilter")}catch(b){}a.isFunction(q.clearToolbar)&&q.clearToolbar(!1)}}catch(b){}switch(f.refreshstate){case "firstpage":A.trigger("reloadGrid",[a.extend({},f.reloadGridOptions||{},{page:1})]);break;case "current":case "currentfilter":A.trigger("reloadGrid",[a.extend({},f.reloadGridOptions||{},{current:!0})])}a.isFunction(f.afterRefresh)&&
f.afterRefresh.call(q)}return!1},ba=function(b,c,d,e,h){var g=a("<div class='ui-pg-button ui-corner-all' tabindex='0' role='button'></div>"),k=f[b+"icon"],l=a.trim(f[b+"text"]);g.append("<div class='ui-pg-div'><span class='"+(f.iconsOverText?Q("ui-pg-button-icon-over-text",y,k):Q(y,k))+"'></span>"+(l?"<span class='ui-pg-button-text"+(f.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+l+"</span>":"")+"</div>");a(e).append(g);g.attr({title:f[b+"title"]||"",id:c||b+"_"+h}).click(d).hover(Z,aa);
return g};f.cloneToTop&&l.toppager&&(C=2);for(B=0;B<C;B++){b=a("<div class='ui-pg-table navtable' role='toolbar' style='float:"+("rtl"===l.direction?"right":"left")+";table-layout:auto;'></div>");0===B?(w=g,z=D,w===l.toppager&&(z+="_top",C=1)):(w=l.toppager,z=D+"_top");f.add&&ba("add",m.id,h,b,z);f.edit&&ba("edit",e.id,J,b,z);f.view&&ba("view",d.id,fa,b,z);f.del&&ba("del",k.id,U,b,z);(f.add||f.edit||f.del||f.view)&&a(b).append(Y);f.search&&(r=ba("search",c.id,ea,b,z),c.showOnLoad&&!0===c.showOnLoad&&
a(r,b).click());f.refresh&&ba("refresh","",V,b,z);r=a(".ui-jqgrid>.ui-jqgrid-view").css("font-size")||"11px";a("body").append("<div id='testpg2' class='"+X.call(q,"gBox","ui-jqgrid")+"' style='font-size:"+r+";visibility:hidden;' ></div>");r=a(b).clone().appendTo("#testpg2").width();a("#testpg2").remove();a(w+"_"+f.position,w).append(b);if(f.hideEmptyPagerParts)for(z=0;z<L.length;z++)L[z]!==f.position&&(M=a(w+"_"+L[z],w),0===M.length||0===M[0].childNodes.length?M.hide():1===M[0].childNodes.length&&
(H=M[0].firstChild,!a(H).is("table.ui-pg-table")||0!==H.rows&&0!==H.rows[0].cells.length||M.hide()));l._nvtd&&(r>l._nvtd[0]&&(a(w+"_"+f.position,w).width(r),l._nvtd[0]=r),l._nvtd[1]=r);q.nav=!0;b.bind("keydown.jqGrid",x)}A.triggerHandler("jqGridResetFrozenHeights")}}})},navButtonAdd:function(g,N){"object"===typeof g&&(N=g,g=void 0);return this.each(function(){var e=this,m=e.p;if(e.grid){var k=a.extend({caption:"newButton",title:"",onClickButton:null,position:"last",cursor:"pointer",iconsOverText:!1},
G.getGridRes.call(a(e),"nav"),n.nav||{},m.navOptions||{},N||{}),c=O.call(e,"hover"),d=O.call(e,"disabled");if(void 0===g)if(m.pager)if(G.navButtonAdd.call(a(e),m.pager,k),m.toppager)g=m.toppager;else return;else m.toppager&&(g=m.toppager);"string"===typeof g&&0!==g.indexOf("#")&&(g="#"+F(g));var m=a(".navtable",g),q=k.commonIconClass;if(0<m.length&&!(k.id&&0<m.find("#"+F(k.id)).length)){var l=a("<div tabindex='0' role='button'></div>");"NONE"===k.buttonicon.toString().toUpperCase()?a(l).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'>"+
(k.caption?"<span class='ui-pg-button-text"+(k.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+k.caption+"</span>":"")+"</div>"):a(l).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'><span class='"+(k.iconsOverText?Q("ui-pg-button-icon-over-text",q,k.buttonicon):Q(q,k.buttonicon))+"'></span>"+(k.caption?"<span class='ui-pg-button-text"+(k.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+k.caption+"</span>":"")+"</div>");k.id&&a(l).attr("id",k.id);"first"===k.position&&
0<m.children("div.ui-pg-button").length?m.children("div.ui-pg-button").first().before(l):m.append(l);a(l,m).attr("title",k.title||"").click(function(c){R(this,d)||a.isFunction(k.onClickButton)&&k.onClickButton.call(e,k,c);return!1}).hover(function(){R(this,d)||a(this).addClass(c)},function(){a(this).removeClass(c)});a(e).triggerHandler("jqGridResetFrozenHeights")}}})},navSeparatorAdd:function(g,n){n=a.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},n||{});return this.each(function(){if(this.grid){var e=
this.p;if(void 0===g)if(e.pager)if(G.navSeparatorAdd.call(a(this),e.pager,n),e.toppager)g=e.toppager;else return;else e.toppager&&(g=e.toppager);"string"===typeof g&&0!==g.indexOf("#")&&(g="#"+F(g));e=a(".navtable",g);if(0<e.length){var m="<div class='ui-pg-button "+O.call(this,"disabled")+"'><span class='"+n.sepclass+"'></span>"+n.sepcontent+"</div>";"first"===n.position?0===e.children("div.ui-pg-button").length?e.append(m):e.children("div.ui-pg-button").first().before(m):e.append(m)}}})},GridToForm:function(g,
n){return this.each(function(){var e,m,k,c;if(this.grid){var d=G.getRowData.call(a(this),g),q=this.p.propOrAttr;if(d)for(e in d)if(d.hasOwnProperty(e))if(m=a("[name="+F(e)+"]",n),m.is("input:radio")||m.is("input:checkbox"))for(k=0;k<m.length;k++)c=a(m[k]),c[q]("checked",c.val()===String(d[e]));else m.val(ja(d[e])?"":d[e])}})},FormToGrid:function(g,n,e,m){return this.each(function(){if(this.grid){e||(e="set");m||(m="first");var k=a(n).serializeArray(),c={};a.each(k,function(a,e){c[e.name]=e.value});
"add"===e?G.addRowData.call(a(this),g,c,m):"set"===e&&G.setRowData.call(a(this),g,c)}})}})});
//# sourceMappingURL=grid.formedit.map
